<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Virtual - Ziloy</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="index-page">
    <header>
        <div class="header-container">
            <h1 class="logo-text"><a href="{{ url_for('index') }}">Ziloy</a></h1>
            <nav>
                <ul class="nav-list">
                    <li><a href="{{ url_for('tienda_virtual') }}">Tienda Virtual</a></li>
                    <li><a href="#" id="ziloyBotLink">Ziloy Bot</a></li>
                    <li><a href="{{ url_for('conocenos') }}">Sobre Nosotros</a></li>
                </ul>
            </nav>
            {% if 'user_id' in session %}
                <a href="{{ url_for('logout') }}" class="btn-login">Cerrar Sesión</a>
            {% else %}
                <a href="{{ url_for('login') }}" class="btn-login">Iniciar Sesión</a>
            {% endif %}
        </div>
    </header>

    <section class="how-it-works py-5">
        <main class="text-center py-1">
            <h2 class="mb-4" style="color:#00c9a7;">Tienda Virtual</h2>
            <p class="lead" style="max-width: 800px; margin: auto;">
                Explora nuestra tienda virtual y descubre productos innovadores diseñados para
                mejorar tu día a día. Calidad, sostenibilidad y tecnología al alcance de tu mano.
            </p>
        </main>
    </section>

    <!-- === SECCIÓN TIENDA VIRTUAL === -->
    <section class="how-it-works">
        <section class="store-section py-5">
            <div class="container d-flex flex-column flex-md-row align-items-center justify-content-center gap-5">

                <!-- IMAGEN DEL PRODUCTO -->
                <div class="product-image text-center">
                    <img id="productImage" src="{{ url_for('static', filename='images/ziloy_negro.png') }}" 
                        alt="Bolsa Térmica Ziloy" class="img-fluid rounded shadow" style="max-width: 350px;">
                    <div class="color-buttons d-flex justify-content-center gap-3 mt-3">
                        <button class="color-btn" id="blackBtn" style="background-color: black;"></button>
                        <button class="color-btn" id="pinkBtn" style="background-color: pink;"></button>
                    </div>
                </div>

                <!-- DETALLES DEL PRODUCTO -->
                <div class="product-details text-center text-md-start">
                    <h2 class="fw-bold" style="color:#00c9a7;">Bolsa Térmica Ziloy</h2>
                    <p>Mantén tus bebidas a la temperatura perfecta, con estilo y tecnología inteligente.</p>

                    <div class="price-box d-flex align-items-center justify-content-center justify-content-md-start gap-3 mt-3">
                        <span id="price" class="price fw-bold fs-4" style="color:#00c9a7;">$89.900</span>

                        <div class="quantity-box d-flex align-items-center border rounded px-2">
                            <button class="btn-qty" id="decreaseBtn">-</button>
                            <input type="text" id="quantity" value="1" class="text-center border-0" style="width: 40px;" readonly>
                            <button class="btn-qty" id="increaseBtn">+</button>
                        </div>
                    </div>

                    <button class="btn mt-4 px-4 py-2 fw-bold text-light" 
                            style="background-color:#00c9a7; border-radius:30px;">Comprar
                    </button>
                </div>
            </div>
        </section>
    </section>

    <footer>
        <p>&copy; 2025 - Ziloy | UCundinamarca y UNL</p>
    </footer>

    <!--CHATBOT FLOTANTE-->
    <div id="chatbotPopup" class="chatbot-popup" style="display:none;">
        <div class="chatbot-header">
            <span>Ziloy Bot</span>
            <button id="closeChatbot" class="chatbot-close">&times;</button>
        </div>
        <div class="chatbot-body">
            <div id="chatMessages"></div>
            <div style="display:flex; gap:8px;">
                <input id="chatInput" type="text" placeholder="Escribe un mensaje..." />
                <button id="sendMessage">Enviar</button>
            </div>
        </div>
    </div>

    <!-- CAMBIO DE COLOR DEL PRODUCTO -->
    <script>
        const productImage = document.getElementById("productImage");
        const blackBtn = document.getElementById("blackBtn");
        const pinkBtn = document.getElementById("pinkBtn");

        blackBtn.addEventListener("click", () => {
            productImage.src = "{{ url_for('static', filename='images/ziloy_negro.png') }}";
        });

        pinkBtn.addEventListener("click", () => {
            productImage.src = "{{ url_for('static', filename='images/ziloy_rosado.png') }}";
        });

        // === CONTROL DE CANTIDAD Y PRECIO ===
        const basePrice = 89900;
        const priceEl = document.getElementById("price");
        const quantityInput = document.getElementById("quantity");
        const increaseBtn = document.getElementById("increaseBtn");
        const decreaseBtn = document.getElementById("decreaseBtn");

        function updatePrice() {
            const quantity = parseInt(quantityInput.value);
            const total = basePrice * quantity;
            priceEl.textContent = `$${total.toLocaleString("es-CO")}`;
        }

        increaseBtn.addEventListener("click", () => {
            let quantity = parseInt(quantityInput.value);
            quantity++;
            quantityInput.value = quantity;
            updatePrice();
        });

        decreaseBtn.addEventListener("click", () => {
            let quantity = parseInt(quantityInput.value);
            if (quantity > 1) {
                quantity--;
                quantityInput.value = quantity;
                updatePrice();
            }
        });

        // === ABRIR / CERRAR CHATBOT ===
        const chatbotPopup = document.getElementById('chatbotPopup');
        const openBotLink = document.getElementById('ziloyBotLink');
        const closeChatbot = document.getElementById('closeChatbot');

        if (openBotLink) {
            openBotLink.addEventListener('click', (e) => {
                e.preventDefault();
                chatbotPopup.style.display = 'flex';
            });
        }

        if (closeChatbot) {
            closeChatbot.addEventListener('click', () => {
                chatbotPopup.style.display = 'none';
            });
        }
    </script>

    <script src="{{ url_for('static', filename='js/chatbot.js') }}"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>